# Debug Mode Usage Guide

## 概要
tdt CLIツールには、テスト用のデータセットを使用してユーザーが操作できるデバッグモードが実装されています。このモードでは、Todoist APIを使用せずにローカルのモックデータでアプリケーションをテストできます。

## 設定方法

### 環境変数

デバッグモードは以下の環境変数で制御されます：

```bash
# デバッグモードの有効化
DEBUG_MODE=true

# 使用するデータセット (オプション、デフォルト: basic)
DEBUG_DATASET=basic

# デバッグ情報の表示 (オプション、デフォルト: false)
DEBUG_SHOW_INFO=true
```

### 利用可能なデータセット

| データセット名 | 説明 |
|---|---|
| `basic` | 基本的な小さなデータセット（5タスク、様々な属性） |
| `priority-showcase` | 優先度の表示テスト用（優先度1-4の各レベル） |
| `due-date-variety` | 期限日のバリエーション（期限切れ、今日、未来、期限なし） |
| `large-dataset` | 大規模データセット（100+タスク、パフォーマンステスト用） |
| `empty` | 空のタスクリスト |
| `project-variety` | 複数プロジェクトにわたるタスク |
| `sorting-test` | ソート機能のテスト用データ |
| `error-conditions` | エラー処理テスト用データ |

## 使用例

### 基本的な使用法

```bash
# 基本データセットでデバッグモードを起動
DEBUG_MODE=true pnpm dev

# 大規模データセットでパフォーマンステスト
DEBUG_MODE=true DEBUG_DATASET=large-dataset pnpm dev

# デバッグ情報を表示してテスト
DEBUG_MODE=true DEBUG_SHOW_INFO=true pnpm dev
```

### .envファイルの使用

プロジェクトルートに`.env`ファイルを作成：

```env
DEBUG_MODE=true
DEBUG_DATASET=priority-showcase
DEBUG_SHOW_INFO=true
```

その後、通常通り起動：

```bash
pnpm dev
```

## デバッグモードの機能

### デバッグ情報の表示

`DEBUG_SHOW_INFO=true`に設定すると、アプリケーション上部に以下の情報が表示されます：

```
🐛 DEBUG MODE: dataset=basic | tasks=5
```

### モック操作

デバッグモードでは、以下の操作がモック実装で動作します：

- ✅ タスクの取得
- ✅ タスクの作成
- ✅ タスクの完了
- ✅ タスクの削除

### ソート機能のテスト

すべてのソート機能が完全に動作します：

- 期限日順（昇順・降順）
- 優先度順（昇順・降順）
- プロジェクト順（昇順・降順）
- 作成日順（昇順・降順）
- タスク名順（昇順・降順）

## トラブルシューティング

### よくある問題

1. **デバッグモードが有効にならない**
   - 環境変数が正しく設定されているか確認
   - `DEBUG_MODE=true`になっているか確認

2. **データセットが変更されない**
   - `DEBUG_DATASET`の値が正しいか確認
   - 利用可能なデータセット名を再確認

3. **デバッグ情報が表示されない**
   - `DEBUG_SHOW_INFO=true`が設定されているか確認

### ログの確認

デバッグモードでは、通常のアプリケーションログに加えて、デバッグ情報が出力されます。

## アーキテクチャ

### ファイル構造

```
src/infra/
├── config.ts                  # デバッグ設定の管理
├── taskService.ts             # API/Mock切り替えサービス
└── mockData/
    └── taskDatasets.ts        # テストデータセット定義
```

### 実装概要

1. **設定検出**: 環境変数に基づいてデバッグモードを判定
2. **サービス抽象化**: `TaskService`インターフェースでAPI/Mockを切り替え
3. **データセット管理**: 各種テストシナリオ用のモックデータを提供
4. **UI表示**: デバッグ情報の条件付き表示

## 開発での活用

デバッグモードは以下の場面で有効です：

- **機能開発**: API無しでUI機能をテスト
- **パフォーマンステスト**: 大量データでの動作確認
- **エラーハンドリング**: 異常系データでのテスト
- **ソート機能**: 様々なデータパターンでの検証
- **レスポンシブテスト**: 異なるデータ量での表示確認